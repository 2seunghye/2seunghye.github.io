---
layout: article
title: Closure
tag: JavaScript
---

function outer(){
    var a = 1;
    console.log(a);
}

outer();

여기서 a에 무슨 값이 들어있는지
찾아야하는데
무슨 값이 들어있는지 찾는 곳이 바로
scope

일종의 표 같은게 그려지겠죠

이 스코프는 어디에 속해있냐?
저 함수.
outer의 범위인 거죠

자바스크립트는 함수단위로 스코프가 생성된다고 생각하시면 돼요

그럼 조금 더 나가보죠 

function outer(){
    var a = 1;

    function inner(){
        var a = 2;
        console.log(a);
    }
    inner();
}

outer();

outer실행을 하면>
2가 찍히는것을 볼 수 있다
a 가 1인지? 2인지??
c찾는 것이 scope 
scope는 함수단위기 때문에
inner용 스코프가 생겨요
그래서
inner 스코프에는 a가 2로 들어와있어

inner에서 찾는거죠......

그럼 조금 더 나가서

function outer(){
    var a = 1;
    var b = "B";

    function inner(){
        var a = 2;
        console.log(b);
    }
    inner();
}

outer();

그럼..? "B"가 찍히죠..
outer에
a = 1
b = "B"
가 들어있죠

inner에서 찍었으니까
inner에서 먼저 찾아보는겁니다
쭉 찾다보니까 b가 없어요
그러니까 그 다음 표를 찾는데
다음 찾는 표가 outer라고 연결이 되어있다.
왜냐면 inner가 생성된 곳이 outer라는 범위 안에 있기 때문 

글로벌 스코프가 따로있음


var d = "X"

function outer(){
    var a = 1;
    var b = "B";

    function inner(){
        var a = 2;
        console.log(d);
    }
    inner();
}

outer();

여기서 d 를 찍으면? X가 나오죠
그럼 여기서 실질적으로 글로벌 스코프가 하나 더있어요..
맨 밖에 선언한거니까...
이 outer를 선언한 곳이 글로벌이죠
그래서 outer 다음에 찾는 곳이 글로벌인것이죠

이렇게 스코프가 연결되있짢아요?
이게바로 스코프체인이에요 

이제.. 클로져
스코프를 다 설명했기때문에 클로저도 다 설명한거나 마찬가지에요


var d = "X"

function outer(){
    var a = 1;
    var b = "B";

    function inner(){
        var a = 2;
        console.log(b);
    }
    return inner;
}

var someFun = outer();
someFun();

그럼 someFun은 outer의 값 즉 inner값을 받는거죠 
받고나서 ㄴomeFun()을 하는거죠

다른 언어의 개념을 생각해보면
outer가 실행되는
outer 내부에서 만들어진 함수는 
실행하는 순간
b의 변수는 사라진다고 생각하잖아요?

근데 여기선 b가 찍혀요
이게바로 클로저
생성한 시점에 스코프 체인을 계속 들고있는다..
들고잇기 때문에 이것이 일ㅈㅇ의 클로저고
이 클로저 때문에
outer가 실행된 다음에도
inner펑션이 아우터에 대한 스코프를 들고있고
글로벌도 들고있는거죠
그래서 밖으로 꺼낸 다음에도
아우터가 실행된 다음에도
아우터의 스코프에 계속 접근할 수 있는거죠 



결국 클로저는 스코프(각 함수마다 존재, 변수 명들의 집합)를 계쏙 들고잇는 거군요?
원래는 함수 내부에 선언한 변수는 함수가 끝나면 사라지지만, 클로저가 스코프를 계속 들고 있으므로 그 함수 내부의 변수를 참조할 수 있게 됨


질문.....
함수가 끝나면 변수가 사라져??????